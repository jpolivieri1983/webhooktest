name: Golden AMI test

on:
  repository_dispatch:
      types: [integration-event]
  workflow_dispatch:    

jobs:
  Update-Golden-AMI:
    runs-on: ubuntu-latest
    permissions:
        contents: write
        pull-requests: write
        actions: write
    steps:
    - uses: actions/checkout@v4
    - run: 'echo "field Previous AMI: ${{ github.event.client_payload.previousAMI }}"'
    - run: 'echo "field Created AMI: ${{ github.event.client_payload.createdAMI }}"'
    - run: 'echo "payload: ${{ toJson(github.event.client_payload) }}"'    
    
    - name: get current time
      id: current_time
      uses: Kaven-Universe/github-action-current-date-time@v1
      with:
        format: "YYYY_MM_DD"

    - name: 2. Create new branch
      id: create_branch
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      run: |
        git branch automation/updateAMI-${{ steps.current_time.outputs.time }}-${{ github.repository }}
        git checkout automation/updateAMI-${{ steps.current_time.outputs.time }}-${{ github.repository }}
    #- run: echo "Your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."    
